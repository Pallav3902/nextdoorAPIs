openapi: 3.0.1
info:
  title: Next Door
  description: 'Collection of Microservices'
  contact:
    email: ukbaranwal@gmail.com
  version: 1.0.0
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT 
servers:
- url: http://localhost:3000
tags:
- name: Vendor
  description: APIs for Vendors
- name: User
  description: APIs for Users
- name: Delivery Boys
  description: APIs for Delivery Boys
- name: Admin
  description: APIs for Admin

security:
  - bearerAuth: [] 

paths:
  /vendors/signup:
    post:
      tags:
      - Vendor
      summary: Signups a Vendor
      operationId: signupVendor
      requestBody:
        description: Vendor object that needs to be added
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Vendor'
        required: true
      responses:
        200:
          description: Vendor already Registered
        201:
          description: Signup was Successfull
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
          content: {}
  /vendors/signin:
    post:
      tags: 
        - Vendor
      summary: Logins a Vendor
      operationId: loginVendor
      requestBody:
        description: Email ID and Password of Vendor
        content:
          application/json:
            schema:
              required: 
                - email
                - password
              type: object
              properties: 
                email:
                  type: string
                  example: mystore@gmail.com
                password:
                  type: string
                  example: 123$%mystore
        required: true
      responses:
        202:
          description: Login was Successfull
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VendorResponse'
        204:
          description: Vendor not found
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
  /vendors/forgotPassword:
    post:
      tags: 
        - Vendor
      summary: Used to request reset pin to change password for vendors
      operationId: forgotPasswordRequest
      requestBody: 
        description: Email ID of Vendor
        content:
          application/json:
            schema: 
              required:
                - email
              type: object
              properties: 
                email:
                  type: string
                  example: mystore@gmail.com
        required: true
      responses:
        200:
          description: Reset Pin has been sent on Email 
        204:
          description: Vendor not found
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
    patch:
      tags:
        - Vendor
      summary: Used to change password with the requested Pin
      operationId: forgotPasswordChange
      requestBody:
        description: Email ID along with Password and Secret Pin
        content:
          application/json:
            schema:
              required:
                - email
                - password
                - pin 
              type: object
              properties:
                email:
                  type: string
                  example: mystore@gmail.com
                password:
                  type: string
                  example: 123$%mystore
                pin: 
                  type: string
                  example: 1234
        required: true
      responses:
        202:
          description: Password has been changed
        204:
          description: Vendor not found
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
  /vendors/changePassword:
    patch:
      tags: 
        - Vendor
      summary: Used to change password for vendors
      operationId: changePassword
      requestBody: 
        description: old and new password
        content:
          application/json:
            schema: 
              required:
                - password
                - new_password
              type: object
              properties: 
                password:
                  type: string
                  example: 12345j63
                new_password:
                  type: string
                  example: 123rf43re
        required: true
      responses:
        202:
          description: Password Successfully changed
        401:
          description: Unauthorized Access
        204:
          description: Vendor not found
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
  /vendors/status:
    patch:
      tags: 
        - Vendor
      summary: Updates Shop status if it is open or closed
      operationId: updateStatus
      requestBody:
        description: boolean value shop_open
        content:
          application/json:
            schema:
              required: 
                - shop_open
              type: object
              properties: 
                shop_open:
                  type: boolean
                  example: false
        required: true
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
  /vendors/dashboard:
    patch:
      tags: 
        - Vendor
      summary: Updates Dashboard
      operationId: updateDashboard
      requestBody:
        description: Used by vendors only first time
        content:
          application/json:
            schema:
              required: 
                - name
                - shop_name
                - address
                - city
                - tags
              type: object
              properties: 
                name:
                  type: string
                  example: Utkarsh
                shop_name:
                  type: string
                  example: UB Stores
                address:
                  type: string
                  example: B14/172
                city:
                  type: string
                  example: Kalyani
                tags:
                  type: string
                  example: Clothes, Shop
        required: true
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
  /vendors/dashboardLogo:
    patch:
      tags: 
        - Vendor
      summary: Updates Shop Logo
      operationId: updateDashboardLogo
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                image:
                  type: string
                  format: binary

      required: true
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error    
    delete:
      tags: 
        - Vendor
      summary: Deletes Shop Logo
      operationId: deleteDashboardLogo
      responses:
        200:
          description: Successfully Deleted
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error     
  /vendors/shopTime:
    patch:
      tags: 
        - Vendor
      summary: Updates Shop Timing
      operationId: updateTime
      requestBody:
        description: Used by vendors to update there timings
        content:
          application/json:
            schema:
              required: 
                - opening_time
                - closing_time
              type: object
              properties: 
                opening_time:
                  type: string
                  example: 10AM
                closing_time:
                  type: string
                  example: 11PM
      required: true
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error  
  /vendors/shopLocation:
    patch:
      tags: 
        - Vendor
      summary: Updates Location
      operationId: updateLocation
      requestBody:
        description: Used by vendors to update their location
        content:
          application/json:
            schema:
              required: 
                - location_lat
                - location_long
              type: object
              properties: 
                location_lat:
                  type: string
                  example: 3.123245676564532
                location_long:
                  type: string
                  example: 4.2324565653425664
      required: true
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error    
  /vendors/product:
    put:
      tags: 
        - Vendor
      summary: Adds a new product
      operationId: addProduct
      requestBody:
        description: Used by vendors to add their products
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                images:
                  type: array
                  items:
                    type: string
                    format: binary
              $ref: '#/components/schemas/ProductRequest'
      required: true
      responses:
        201:
          description: Successfully Added
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error   
    patch:
      tags: 
        - Vendor
      summary: Edits a product
      operationId: editProduct
      requestBody:
        description: Used by vendors to edit their products
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductEditRequest'
      required: true
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error 
    delete:
      tags: 
        - Vendor
      summary: Deletes a product
      operationId: deleteProduct
      requestBody:
        description: Used by vendors to delete their products
        content:
          application/json:
            schema:
              required:
                - product_id
              type: object
              properties:
                product_id:
                  type: integer
                  example: 1
      required: true
      responses:
        200:
          description: Successfully Deleted
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error 
  /vendors/productInStock:
    patch:
      tags:
        - Vendor
      summary: Updates product when instock or outofstock
      operationId: productInStock
      requestBody:
        description: Used by vendors to update their products if they are in stock
        content:
          application/json:
            schema:
              required:
                - product_id
                - in_stock
              type: object
              properties:
                product_id:
                  type: integer
                  example: 1
                in_stock:
                  type: boolean
                  example: true
      required: true
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error 
  /vendors/productImage:
    put:
      tags:
        - Vendor
      summary: Updates product's Image
      operationId: productAddImage
      requestBody:
        description: Used by vendors to update their products images
        content:
          multipart/form:
            schema:
              required:
                - product_id
                - image
              type: object
              properties:
                product_id:
                  type: integer
                  example: 1
                image:
                  type: string
                  format: binary
      required: true
      responses:
        201:
          description: Successfully Uploaded
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        406:
          description: Maximum no. of images reached
        422:
          description: Validation Failed
        500:
          description: Server Error
    delete:
      tags:
        - Vendor
      summary: Deletes product's Image
      operationId: productDeleteImage
      requestBody:
        description: Used by vendors to delete their products images
        content:
          application/json:
            schema:
              required:
                - product_id
                - image_url
              type: object
              properties:
                product_id:
                  type: integer
                  example: 1
                image:
                  type: string
                  example: a.jpeg
      required: true
      responses:
        200:
          description: Successfully Uploaded
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        406:
          description: Maximum no. of images reached
        422:
          description: Validation Failed
        500:
          description: Server Error
  /admins/signup:
    post:
      tags:
      - Admin
      summary: Signups an Admin
      operationId: signupAdmin
      requestBody:
        description: An Admin get Registered
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Vendor'
        required: true
      responses:
        200:
          description: Admin already Registered
        201:
          description: Signup was Successfull
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
          content: {}
  /admins/signin:
    post:
      tags: 
        - Admin
      summary: Logins an Admin
      operationId: loginAdmin
      requestBody:
        description: Email ID and Password of Admin
        content:
          application/json:
            schema:
              required: 
                - email
                - password
              type: object
              properties: 
                email:
                  type: string
                  example: mystore@gmail.com
                password:
                  type: string
                  example: 123$%mystore
        required: true
      responses:
        202:
          description: Login was Successfull
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VendorResponse'
        204:
          description: Vendor not found
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
  /admins/vendorType:
    put:
      tags: 
        - Admin
      summary: Used to add more vendors type or categories
      operationId: addVendorType
      requestBody:
        content:
          multipart/form:
            schema:
              required: 
                - name
                - service
                - standard_quantity_selling
                - delivery_boy_needed
                - store_needed
                - image
              type: object
              properties: 
                name:
                  type: string
                  example: ABC
                service:
                  type: boolean
                  example: false
                selling:
                  type: boolean
                  example: true
                delivery_boy_needed:
                  type: boolean
                  example: true
                store_needed:
                  type: boolean
                  example: true
                image:
                  type: string
                  format: binary
        required: true
      responses:
        200:
          description: category already exists
        201:
          description: category added
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
    patch:
      tags: 
        - Admin
      summary: Updates Vendor type
      operationId: updateVendorType
      requestBody:
        description: Used by admins to update vendor category
        content:
          multipart/form:
            schema:
              required: 
                - name
                - service
                - standard_quantity_selling
                - delivery_boy_needed
                - store_needed
              type: object
              properties: 
                name:
                  type: string
                  example: ABC
                service:
                  type: boolean
                  example: false
                selling:
                  type: boolean
                  example: true
                delivery_boy_needed:
                  type: boolean
                  example: true
                store_needed:
                  type: boolean
                  example: true
                image:
                  type: string
                  format: binary
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
    delete:
      tags: 
        - Admin
      summary: Deletes vendor categories
      operationId: deleteVendorType
      requestBody:
        content:
          application/json:
            schema:
              required:
                - id
              type: object
              properties:
                id:
                  type: integer
                  format: 1
      required: true
      responses:
        200:
          description: Successfully Deleted
        401:
          description: Unauthorized Access
        403:
          description: Forbidden Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error    
  /admins/productCategory:
    put:
      tags: 
        - Admin
      summary: Adds product categories
      operationId: addProductCategory
      requestBody:
        description: Used by admins to create new product categories 
        content:
          multipart/form:
            schema:
              required: 
                - name
                - quantity_by_weight
                - quantity_by_piece
              type: object
              properties: 
                name:
                  type: string
                  example: Tshirt
                parent_id:
                  type: string
                  example: 1
                tags:
                  type: string
                  example: Tshirt,Men's Tshirt
                quantity_by_weight:
                  type: boolean
                  example: false
                quantity_by_piece:
                  type: boolean
                  example: true
                image:
                  type: string
                  format: binary
      required: true
      responses:
        200:
          description: Already exists
        201:
          description: Successfully Added
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error 
    patch:
      tags: 
        - Admin
      summary: Edit product categories
      operationId: editProductCategory
      requestBody:
        description: Used by admins to edit product categories 
        content:
          multipart/form:
            schema:
              required: 
                - id
                - name
                - quantity_by_weight
                - quantity_by_piece
              type: object
              properties: 
                id:
                  type: integer
                  example: 1
                name:
                  type: string
                  example: Tshirt
                parent_id:
                  type: string
                  example: 1
                tags:
                  type: string
                  example: Tshirt,Men's Tshirt
                quantity_by_weight:
                  type: boolean
                  example: false
                quantity_by_piece:
                  type: boolean
                  example: true
                image:
                  type: string
                  format: binary
      required: true
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
    delete:
      tags: 
        - Admin
      summary: Deletes product categories
      operationId: deleteProductCategory
      requestBody:
        description: Used by admins to delete product categories 
        content:
          application/json:
            schema:
              required: 
                - id
              type: object
              properties: 
                id:
                  type: integer
                  example: 1
      required: true
      responses:
        200:
          description: Successfully Deleted
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error  
  /admins/productTemplate:
    put:
      tags: 
        - Admin
      summary: Adds product templates
      operationId: addProductTemplate
      requestBody:
        description: Used by admins to create new product templates 
        content:
          multipart/form:
            schema:
              required: 
                - name
                - description
                - product_category_id
                - standard_quantity_selling
                - mrp 
                - tags
                - images
              type: object
              properties: 
                name:
                  type: string
                  example: Roadster Tshirt
                description:
                  type: string
                  example: Roadster Tshirt for men
                brand:
                  type: string
                  example: Roadster
                product_category_id:
                  type: integer
                  example: 1
                standard_quantity_selling:
                  type: integer
                  example: 1
                mrp:
                  type: float
                  example: 499.0
                tags:
                  type: string
                  example: Roadster, Tshirt, Men's Tshirt
                images:
                  type: string
                  format: binary
      required: true
      responses:
        201:
          description: Successfully Added
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error 
    patch:
      tags: 
        - Admin
      summary: Edit product templates
      operationId: editProductTemplate
      requestBody:
        description: Used by admins to edit product templates 
        content:
         application/json:
            schema:
              required:
                - product_template_id 
                - name
                - description
                - product_category_id
                - standard_quantity_selling
                - mrp 
                - tags
              type: object
              properties: 
                name:
                  type: string
                  example: Roadster Tshirt
                description:
                  type: string
                  example: Roadster Tshirt for men
                brand:
                  type: string
                  example: Roadster
                product_category_id:
                  type: integer
                  example: 1
                standard_quantity_selling:
                  type: integer
                  example: 1
                mrp:
                  type: float
                  example: 499.0
                tags:
                  type: string
                  example: Roadster, Tshirt, Men's Tshirt
      required: true
      responses:
        200:
          description: Successfully Updated
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        422:
          description: Validation Failed
        500:
          description: Server Error
  /admins/productTemplateImage:
    put:
      tags: 
        - Admin
      summary: Add images in product templates
      operationId: editProductTemplateImage
      requestBody:
        description: Used by admins to add product templates images
        content:
         multipart/form:
            schema:
              required:
                - product_template_id 
                - image
              type: object
              properties: 
                product_template_id:
                  type: integer
                  example: 1
                image:
                  type: string
                  format: binary
      required: true
      responses:
        201:
          description: Successfully Uploaded
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        406:
          description: Maximum no. of photis reached
        422:
          description: Validation Failed
        500:
          description: Server Error
    delete:
      tags: 
        - Admin
      summary: Deletes images from product templates
      operationId: deleteProductTemplateImage
      requestBody:
        description: Used by admins to delete product templates images
        content:
         application/json:
            schema:
              required:
                - product_template_id 
                - image_url
              type: object
              properties: 
                product_template_id:
                  type: integer
                  example: 1
                image_url:
                  type: string
                  example: image.jpeg
      required: true
      responses:
        200:
          description: Successfully Uploaded
        401:
          description: Unauthorized Access
        404:
          description: Not Found
        406:
          description: Maximum no. of photis reached
        422:
          description: Validation Failed
        500:
          description: Server Error
components:
  schemas:
    ProductEditRequest:
      required: 
        - name
        - description
        - product_category_id
        - standard_quantity_selling
        - mrp 
        - discount_percentage
        - max_quantity
        - tags
      type: object
      properties: 
        name:
          type: string
          example: Roadster Tshirt
        description:
          type: string
          example: Roadster Tshirt for men
        brand:
          type: string
          example: Roadster
        product_category_id:
          type: integer
          example: 1
        standard_quantity_selling:
          type: integer
          example: 1
        mrp:
          type: float
          example: 499.0
        discount_percentage:
          type: integer
          example: 30
        max_quantity:
          type: float
          example: 5
        tags:
          type: string
          example: Roadster, Tshirt, Men's Tshirt
    ProductRequest:
      allOf:  
        - $ref: '#/components/schemas/ProductEditRequest'
        - type: object
          properties:
            images:
              type: array
              items:
                type: string
                format: binary
    Vendor:
      required:
      - name
      - email
      - phone
      - password
      - city
      - vendor_type
      type: object
      properties:
        name:
          type: string
          example: My Store
        email:
          type: string
          example: mystore@gmail.com
        city: 
          type: string
          example: Kalyani
        phone:
          type: string
          example: 1234567890
        password:
          type: string
          example: 123$%mystore
        vendor_type:
          type: integer
          example: 1
    VendorResponse:
      type: object
      properties:
        vendor_type:
          type: integer
          example: 1
        image_url: 
          type: string
          example: https://cdn.geekwire.com/wp-content/uploads/2020/02/amzngo1-630x420.jpeg
        name:
          type: string
          example: My Store
        email:
          type: string
          example: mystore@gmail.com
        phone:
          type: string
          example: 1234567890
        address: 
          type: string
          example: B-14/419
        password:
          type: string
          example: 123$%mystore
        opt_for_delivery_boy:
          type: boolean
          example: false
        local_store:
          type: boolean
          example: false
        owns_store: 
          type: boolean
          example: false
        tags:
          type: string
          example: grocery,food,shop
        shop_open:
          type: boolean
          example: true
        no_of_rating:
          type: integer
          example: 100
        rating:
          type: float
          example: 4.1
        verified:
          type: boolean
          example: true
        local_store:
          type: boolean
          example: false
        upi_id:
          type: string
          example: mystore@paytm
        paytm_no:
          type: string
          example: 1234567890
        location_lat:
          type: string
          example: "0.342455432"
        location_long:
          type: string
          example: "0.342455432"
        membership_active:
          type: boolean
          example: true
        payable: 
          type: float
          example: 1000.0
        owns_store: 
          type: boolean
          example: true
        opening_time: 
          type: string
          example: 11:00
        closing_time:
          type: string
          example: 8:00
        
